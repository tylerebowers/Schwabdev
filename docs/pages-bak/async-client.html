<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schwabdev Documentation</title>
    <link rel="stylesheet" href="../lib/pages.css">
    <link rel="stylesheet" href="../lib/prism.css">
    <script src="../lib/prism.js"></script>
</head>

<body>

    <h1 id="using-the-async-client">Using the AsyncClient</h1>
    <p>The AsyncClient provides asynchronous support for making concurrent API calls to the Schwab API.</p>

    <h2>Basic Usage</h2>

    <pre><code class="language-python">
import asyncio
import schwabdev

async def main():
    async with schwabdev.AsyncClient(app_key, app_secret, callback_url) as client:
        accounts = await client.account_linked()
        print(accounts)

asyncio.run(main())
</code></pre>

    <h2>Constructor Parameters</h2>
    <p>Same as the regular Client:</p>
    <code>schwabdev.AsyncClient(app_key, app_secret, callback_url="https://127.0.0.1", tokens_file="tokens.json", timeout=10, capture_callback=False, call_on_notify=None)</code>

    <h2>Concurrent API Calls</h2>
    <p>Make multiple API calls simultaneously:</p>

    <pre><code class="language-python">
async def main():
    tickers = ["AAPL", "MSFT", "GOOGL", "AMZN", "TSLA"]
    
    async with schwabdev.AsyncClient(os.getenv("app_key"), os.getenv("app_secret"), os.getenv("callback_url")) as client:
        async with asyncio.TaskGroup() as tg:
            results = [tg.create_task(client.price_history(
                i,
                periodType="day",
                period=1,
                frequencyType="minute",
                frequency=5,
                needExtendedHoursData="False",
                startDate=datetime(2025, 5, 5),
                endDate=datetime(2025, 5, 6),
            )) for i in tickers]

        print([result.result() for result in results])
</code></pre>

    <p><strong>Note:</strong> For compatibility with aiohttp, boolean values in API parameters (such as needExtendedHoursData) must be passed as strings ("True" or "False"), not as Python bool types. For more details, see <a href="https://github.com/aio-libs/yarl#why-isnt-boolean-supported-by-the-url-query-api" target="_blank">Why isn't boolean supported by the URL query API?</a></p>

</body>

</html>